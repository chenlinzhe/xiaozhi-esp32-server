# AIé™ªä¼´åŠŸèƒ½æ¨¡å—

## é¡¹ç›®æ¦‚è¿°

AIé™ªä¼´åŠŸèƒ½æ¨¡å—æ˜¯ä¸ºç‰¹æ®Šå„¿ç«¥æä¾›å¼•å¯¼å¼åœºæ™¯å¯¹è¯è®­ç»ƒçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ”¯æŒ300+ç§åœºæ™¯é…ç½®ï¼Œé€šè¿‡è¯­éŸ³ã€è§†è§‰ã€æŒ‰é’®ç­‰å¤šç§è§¦å‘æ–¹å¼ï¼Œä¸ºå„¿ç«¥æä¾›ä¸ªæ€§åŒ–çš„æ•™å­¦ä½“éªŒã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½
- **åœºæ™¯é…ç½®åŒ–** - æ‰€æœ‰å¯¹è¯æµç¨‹é€šè¿‡é…ç½®å®ç°ï¼Œæ— éœ€ç¼–ç¨‹
- **æ™ºèƒ½åˆ¤æ–­** - æ”¯æŒå®Œå…¨åŒ¹é…ã€éƒ¨åˆ†åŒ¹é…ã€å…³é”®è¯åŒ¹é…ç­‰å¤šç§æˆåŠŸæ¡ä»¶
- **ä¸ªæ€§åŒ–ä½“éªŒ** - æ”¯æŒå„¿ç«¥å§“åè®°å¿†ã€æ‰‹åŠ¿æç¤ºã€éŸ³æ•ˆæ”¯æŒ
- **å¤šè§¦å‘æ–¹å¼** - æ”¯æŒè¯­éŸ³ã€è§†è§‰ã€æŒ‰é’®ç­‰å¤šç§è§¦å‘æ–¹å¼
- **å­¦ä¹ è®°å½•** - å®Œæ•´çš„è¿›åº¦è·Ÿè¸ªå’Œç»Ÿè®¡åˆ†æåŠŸèƒ½

### ğŸ“Š æ”¯æŒåœºæ™¯ç±»å‹
- **è¡¨è¾¾éœ€æ±‚** - å£æ¸´ã€é¥¥é¥¿ã€ä¸Šå•æ‰€ç­‰åŸºæœ¬éœ€æ±‚è¡¨è¾¾
- **é—®å€™è¯­** - æ—¥å¸¸é—®å€™ã€ç¤¼è²Œç”¨è¯­è®­ç»ƒ
- **æƒ…æ„Ÿè¡¨è¾¾** - å¼€å¿ƒã€éš¾è¿‡ã€ç”Ÿæ°”ç­‰æƒ…æ„Ÿè¡¨è¾¾
- **ç¤¾äº¤æŠ€èƒ½** - åˆ†äº«ã€åˆä½œã€æ²Ÿé€šç­‰ç¤¾äº¤æŠ€èƒ½
- **å­¦ä¹ è®­ç»ƒ** - æ•°å­¦ã€è¯­è¨€ã€è®¤çŸ¥ç­‰å­¦ä¹ å†…å®¹
- **æ¸¸æˆäº’åŠ¨** - è¶£å‘³æ¸¸æˆå’Œäº’åŠ¨è®­ç»ƒ

## æŠ€æœ¯æ¶æ„

### åç«¯æ¶æ„
```
Spring Boot + MyBatis Plus
â”œâ”€â”€ Entityå±‚ - æ•°æ®å®ä½“
â”œâ”€â”€ Mapperå±‚ - æ•°æ®è®¿é—®
â”œâ”€â”€ Serviceå±‚ - ä¸šåŠ¡é€»è¾‘
â””â”€â”€ Controllerå±‚ - APIæ¥å£
```

### å‰ç«¯æ¶æ„
```
Vue.js + Element UI
â”œâ”€â”€ Views - é¡µé¢ç»„ä»¶
â”œâ”€â”€ APIs - æ¥å£è°ƒç”¨
â””â”€â”€ Router - è·¯ç”±é…ç½®
```

### è®¾å¤‡ç«¯æ¶æ„
```
Python + WebSocket
â”œâ”€â”€ ScenarioManager - åœºæ™¯ç®¡ç†
â”œâ”€â”€ DialogueExecutor - å¯¹è¯æ‰§è¡Œ
â””â”€â”€ ScenarioTrigger - åœºæ™¯è§¦å‘
```

## å¼€å‘å®Œæˆæƒ…å†µ

### âœ… å·²å®ŒæˆåŠŸèƒ½

#### 1. æ•°æ®åº“è®¾è®¡ä¸åŸºç¡€æ¶æ„ (100%å®Œæˆ)
- [x] æ•°æ®åº“è¡¨ç»“æ„è®¾è®¡
- [x] åç«¯å®ä½“ç±»å¼€å‘
- [x] Mapperæ¥å£å¼€å‘
- [x] Serviceå±‚å®ç°
- [x] Controllerå±‚APIå¼€å‘

#### 2. å¯¹è¯æ­¥éª¤é…ç½®ä¸æ‰§è¡Œå™¨ (100%å®Œæˆ)
- [x] åœºæ™¯ç®¡ç†å™¨ (scenario_manager.py)
- [x] å¯¹è¯æ‰§è¡Œå™¨ (dialogue_executor.py)
- [x] å­¦ä¹ è®°å½•ç®¡ç†å™¨ (learning_record_manager.py)
- [x] è®¾å¤‡ç«¯é›†æˆ

#### 3. å‰ç«¯ç•Œé¢å¼€å‘ (100%å®Œæˆ)
- [x] åœºæ™¯é…ç½®é¡µé¢ (ScenarioConfig.vue)
- [x] åœºæ™¯åˆ›å»ºé¡µé¢ (ScenarioCreate.vue)
- [x] åœºæ™¯ç¼–è¾‘é¡µé¢ (ScenarioEdit.vue)
- [x] æ­¥éª¤é…ç½®é¡µé¢ (ScenarioStepConfig.vue)
- [x] å­¦ä¹ è®°å½•ç®¡ç†é¡µé¢ (LearningRecordManagement.vue)

#### 4. APIæ¥å£å¼€å‘ (100%å®Œæˆ)
- [x] åœºæ™¯ç®¡ç†API (ScenarioController.java)
- [x] æ­¥éª¤ç®¡ç†API (ScenarioStepController.java)
- [x] æ¨¡æ¿ç®¡ç†API (StepTemplateController.java)
- [x] å­¦ä¹ è®°å½•API (ChildLearningRecordController.java)
- [x] å‰ç«¯APIæ¨¡å— (scenario.js)

#### 5. æµ‹è¯•éªŒè¯ (100%å®Œæˆ)
- [x] é›†æˆæµ‹è¯•è„šæœ¬ (test_scenario_integration.py)
- [x] æ€§èƒ½æµ‹è¯•è„šæœ¬ (test_scenario_performance.py)
- [x] APIæµ‹è¯•è„šæœ¬ (test_scenario_api.js)

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚
- Java 8+
- Node.js 12+
- Python 3.7+
- MySQL 5.7+

### 2. æ•°æ®åº“éƒ¨ç½²
```sql
-- æ‰§è¡Œæ•°æ®åº“è„šæœ¬
source main/manager-api/src/main/resources/db/changelog/20241201_001_create_ai_scenario_tables.sql
```

### 3. åç«¯éƒ¨ç½²
```bash
# ç¼–è¯‘æ‰“åŒ…
cd main/manager-api
mvn clean package

# è¿è¡Œ
java -jar target/manager-api.jar
```

### 4. å‰ç«¯éƒ¨ç½²
```bash
# å®‰è£…ä¾èµ–
cd main/manager-web
npm install

# å¼€å‘ç¯å¢ƒè¿è¡Œ
npm run serve

# ç”Ÿäº§ç¯å¢ƒæ„å»º
npm run build
```

### 5. è®¾å¤‡ç«¯éƒ¨ç½²
```bash
# å®‰è£…ä¾èµ–
cd main/xiaozhi-server
pip install -r requirements.txt

# è¿è¡ŒæœåŠ¡
python app.py
```

## APIæ¥å£æ–‡æ¡£

### åœºæ™¯ç®¡ç†API
- `GET /xiaozhi/scenario/list` - è·å–åœºæ™¯åˆ—è¡¨
- `GET /xiaozhi/scenario/{id}` - è·å–åœºæ™¯è¯¦æƒ…
- `POST /xiaozhi/scenario` - ä¿å­˜åœºæ™¯
- `PUT /xiaozhi/scenario/{id}` - æ›´æ–°åœºæ™¯
- `DELETE /xiaozhi/scenario/{id}` - åˆ é™¤åœºæ™¯
- `PUT /xiaozhi/scenario/{id}/toggle` - å¯ç”¨/ç¦ç”¨åœºæ™¯

### æ­¥éª¤ç®¡ç†API
- `GET /xiaozhi/scenario-step/list/{scenarioId}` - è·å–æ­¥éª¤åˆ—è¡¨
- `POST /xiaozhi/scenario-step/batch-save/{scenarioId}` - æ‰¹é‡ä¿å­˜æ­¥éª¤
- `DELETE /xiaozhi/scenario-step/{id}` - åˆ é™¤æ­¥éª¤

### å­¦ä¹ è®°å½•API
- `GET /xiaozhi/learning-record/list` - è·å–å­¦ä¹ è®°å½•åˆ—è¡¨
- `GET /xiaozhi/learning-record/{id}` - è·å–å­¦ä¹ è®°å½•è¯¦æƒ…
- `POST /xiaozhi/learning-record` - ä¿å­˜å­¦ä¹ è®°å½•
- `PUT /xiaozhi/learning-record/{id}` - æ›´æ–°å­¦ä¹ è®°å½•
- `DELETE /xiaozhi/learning-record/{id}` - åˆ é™¤å­¦ä¹ è®°å½•

## ä½¿ç”¨ç¤ºä¾‹

### 1. åˆ›å»ºåœºæ™¯
```javascript
// å‰ç«¯APIè°ƒç”¨ç¤ºä¾‹
Api.scenario.saveScenario({
  scenarioName: 'å£æ¸´è¡¨è¾¾è®­ç»ƒ',
  scenarioCode: 'thirst_expression',
  scenarioType: 'express_needs',
  triggerType: 'voice',
  triggerKeywords: '["æ¸´äº†", "å£æ¸´", "å–æ°´"]',
  description: 'è®­ç»ƒå„¿ç«¥è¡¨è¾¾å£æ¸´éœ€æ±‚',
  difficultyLevel: 1,
  targetAge: '3-6'
}, (res) => {
  console.log('åœºæ™¯åˆ›å»ºæˆåŠŸ:', res);
});
```

### 2. é…ç½®æ­¥éª¤
```javascript
// é…ç½®å¯¹è¯æ­¥éª¤
const steps = [
  {
    stepName: 'é—®å€™',
    aiMessage: 'ä½ å¥½ï¼Œ**{childName}**ï¼',
    expectedKeywords: '["ä½ å¥½"]',
    expectedPhrases: '["ä½ å¥½", "hi"]',
    successCondition: 'partial',
    maxAttempts: 3
  },
  {
    stepName: 'éœ€æ±‚è¡¨è¾¾',
    aiMessage: 'ä½ æƒ³å–æ°´å—ï¼Ÿ',
    expectedKeywords: '["æƒ³", "è¦"]',
    expectedPhrases: '["æƒ³å–æ°´", "è¦å–æ°´"]',
    successCondition: 'partial',
    maxAttempts: 3
  }
];

Api.scenario.saveScenarioSteps(scenarioId, steps, (res) => {
  console.log('æ­¥éª¤é…ç½®æˆåŠŸ:', res);
});
```

### 3. è®¾å¤‡ç«¯è§¦å‘
```python
# è®¾å¤‡ç«¯åœºæ™¯è§¦å‘ç¤ºä¾‹
async def handle_voice_input(text):
    # æ£€æµ‹åœºæ™¯è§¦å‘
    triggered_scenario = await scenario_trigger.detect_trigger(text, "voice")
    if triggered_scenario:
        # å¼€å§‹åœºæ™¯å¯¹è¯
        executor = DialogueStepExecutor(triggered_scenario['id'], "å°æ˜")
        await executor.initialize()
        
        # æ‰§è¡Œå¯¹è¯æ­¥éª¤
        result = executor.execute_current_step(text)
        print(f"å¯¹è¯ç»“æœ: {result}")
```

## æµ‹è¯•éªŒè¯

### è¿è¡ŒAPIæµ‹è¯•
```bash
# å®‰è£…ä¾èµ–
npm install axios

# è¿è¡ŒAPIæµ‹è¯•
node test_scenario_api.js
```

### è¿è¡Œé›†æˆæµ‹è¯•
```bash
# è¿è¡Œåœºæ™¯é›†æˆæµ‹è¯•
python test_scenario_integration.py

# è¿è¡Œæ€§èƒ½æµ‹è¯•
python test_scenario_performance.py
```

## æ€§èƒ½æŒ‡æ ‡

- **å¹³å‡å“åº”æ—¶é—´**: < 100ms
- **å†…å­˜ä½¿ç”¨**: < 50MB
- **å¹¶å‘å¤„ç†**: æ”¯æŒ10ä¸ªå¹¶å‘ä¼šè¯
- **å‰ç«¯åŠ è½½æ—¶é—´**: < 2ç§’

## æ‰©å±•æ€§è®¾è®¡

### 1. æ¨¡å—åŒ–è®¾è®¡
- åœºæ™¯æ¨¡å—ç‹¬ç«‹
- æ­¥éª¤æ¨¡å—ç‹¬ç«‹
- æ¨¡æ¿æ¨¡å—ç‹¬ç«‹
- å­¦ä¹ è®°å½•æ¨¡å—ç‹¬ç«‹

### 2. é…ç½®åŒ–æ”¯æŒ
- åœºæ™¯ç±»å‹å¯æ‰©å±•
- è§¦å‘æ–¹å¼å¯æ‰©å±•
- æˆåŠŸæ¡ä»¶å¯æ‰©å±•

### 3. æ’ä»¶åŒ–æ¶æ„
- æ”¯æŒè‡ªå®šä¹‰æ­¥éª¤ç±»å‹
- æ”¯æŒè‡ªå®šä¹‰è§¦å‘æ–¹å¼
- æ”¯æŒè‡ªå®šä¹‰åˆ¤æ–­é€»è¾‘

## å¼€å‘å›¢é˜Ÿ

- **åç«¯å¼€å‘**: xiaozhiå¼€å‘ç»„
- **å‰ç«¯å¼€å‘**: xiaozhiå¼€å‘ç»„
- **æµ‹è¯•**: xiaozhiå¼€å‘ç»„

## ç‰ˆæœ¬ä¿¡æ¯

- **å½“å‰ç‰ˆæœ¬**: v1.0
- **å¼€å‘å®Œæˆæ—¶é—´**: 2024å¹´12æœˆ
- **æœ€åæ›´æ–°**: 2024å¹´12æœˆ

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

---

**æ³¨æ„**: æœ¬é¡¹ç›®ä¸ºç‰¹æ®Šå„¿ç«¥æ•™è‚²è¾…åŠ©å·¥å…·ï¼Œè¯·åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æ³¨æ„ä¿æŠ¤å„¿ç«¥éšç§å’Œå®‰å…¨ã€‚
